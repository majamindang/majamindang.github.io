<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Math Challenge for Kiel</title>
</head>
<body>
    <div class="topScore showThis" class="inc">
        <span class="scoreText">Score:</span><span class="scoreCurrent">0</span> / <span class="scoreTotal">100</span>
    </div>
    <div class="left">
        
    </div>
    <div class="right">
        <p class="description">KIEL's<br>SCORE</p>
        <p class="score"></p>
        <img src="kiel.jpg">
    </div>
    <script>
        const methods = [
            'multiplication'
        ];
        const questions = 100;
        const maxNum = 40;
        const maxNumMultiplication = 9;
        document.querySelector('.score').innerText = `0 / ${questions}`;
        const left = document.querySelector('.left');
        let score = 0;
        let change = 0;

        const topScore = document.querySelector('.topScore');
        const topScoreCurrent = document.querySelector('.scoreCurrent');
        const topScoreTotal = document.querySelector('.scoreTotal');
        topScoreTotal.innerText = questions;

        for(i=0; i < questions; i++){
            let operator = methods[Math.round(Math.random() * (methods.length - 1))];
            let twoNums = [Math.round(Math.random() * maxNum), Math.round(Math.random() * maxNum)];

            if(operator == 'multiplication'){
                twoNums = [Math.round(Math.random() * maxNumMultiplication), Math.round(Math.random() * maxNumMultiplication)];
                console.log(twoNums);
            }

            twoNums = twoNums[0] > twoNums[1] ? [twoNums[0], twoNums[1]] : [twoNums[1], twoNums[0]];
            
            switch(operator) {
                case 'addition':
                    var o = "+";
                    var a = twoNums[0] + twoNums[1];
                    break;
                case 'subtraction':
                    var o = "-";
                    var a = twoNums[0] - twoNums[1];
                    break;
                case 'multiplication':
                    var o = "x";
                    var a = twoNums[0] * twoNums[1];
            }

                left.innerHTML += `<div class="questionField" data-answer="${a}">
            <div class="item">
                <p class="itemNumber">${i + 1}</p>
            </div>
            <div class="itemChallenge">
                <div class="eq">
                    <div class="two">
                        <p class="first">${twoNums[0]}</p>
                        <p class="second">${twoNums[1]}</p>
                        <p class="operator">${o}</p>
                    </div>
                </div>
                <input type="number" class="answer" placeholder="?">
            </div>
        </div>`;
        }

        function checkScore(){
            let scores = 0;
            let qf = document.querySelectorAll('.questionField');
            for(i=0; i < qf.length; i++){
                if(qf[i].querySelector('input').value === qf[i]['dataset']['answer']){
                    scores++;
                }
            }
            score = scores;
            document.querySelector('.score').innerText = `${score} / ${questions}`;
            topScoreCurrent.innerText = score;
        }

        const questionFields = document.querySelectorAll('.questionField input');
        for(i=0; i < questionFields.length; i++){
            questionFields[i].addEventListener('keyup', function(e){
                if(this.value != parseInt(this.parentElement.parentElement['dataset']['answer'])){
                    this.parentElement.parentElement.querySelector('.itemNumber').classList.remove('correct');
                    this.parentElement.parentElement.querySelector('.itemNumber').classList.add('wrong');
                } else {
                    this.parentElement.parentElement.querySelector('.itemNumber').classList.remove('wrong');
                    this.parentElement.parentElement.querySelector('.itemNumber').classList.add('correct');
                }
                checkScore();
            });
        }

        window.addEventListener('scroll', e => {
            if(this.scrollY != 0) {
                topScore.classList.add('showThis');
            } else {
                topScore.classList.remove('showThis');
            }
        })
    </script>
</body>
</html>